> **åšä¸»ä»‹ç»ï¼š**
> æœ¬äººä¸“æ³¨äºŽAndroid/java/æ•°æ®åº“/å¾®ä¿¡å°ç¨‹åºæŠ€æœ¯é¢†åŸŸçš„å¼€å‘ï¼Œä»¥åŠæœ‰å¥½å‡ å¹´çš„è®¡ç®—æœºæ¯•ä¸šè®¾è®¡æ–¹é¢çš„å®žæˆ˜å¼€å‘ç»éªŒå’ŒæŠ€æœ¯ç§¯ç´¯ï¼›å°¤å…¶æ˜¯åœ¨å®‰å“ï¼ˆAndroidï¼‰çš„appçš„å¼€å‘å’Œå¾®ä¿¡å°ç¨‹åºçš„å¼€å‘ï¼Œå¾ˆæ˜¯ç†Ÿæ‚‰å’Œäº†è§£ï¼›æœ¬äººä¹Ÿæ˜¯å¤šå¹´çš„Androidå¼€å‘äººå‘˜ï¼›å¸Œæœ›æˆ‘å‘å¸ƒçš„æ­¤ç¯‡æ–‡ä»¶å¯ä»¥å¸®åŠ©åˆ°æ‚¨ï¼›
>
> ðŸ… **æ–‡ç« æœ«å°¾èŽ·å–æºç ä¸‹è½½æ–¹å¼** ðŸ…

#### åŽå°åŠŸèƒ½æ¼”ç¤ºï¼š

![](./res/6abdc82721e84f29b30cd48f1fe0317c.gif)

#### å®¢æˆ·ç«¯åŠŸèƒ½æ¼”ç¤ºï¼š

![](./res/98cd512e343d41b2b9fdd09c3ab01e19.gif)

#### ä¸€ã€é¡¹ç›®ä»‹ç»

> **åŠŸèƒ½éœ€æ±‚**
>
> **1** **ï¼Œç™»å½•éƒ¨åˆ†:ç”¨æˆ·åï¼Œå¯†ç ï¼Œæ³¨å†Œï¼Œå¿˜è®°å¯†ç æ‰¾å›ž**
>
> **2ï¼Œé¢†å¯¼å¼€å¯ç­¾åˆ°** **ï¼Œç­¾é€€ï¼Œ** **5åˆ†é’Ÿä»¥å†…ï¼ŒèŒå·¥** **ç­¾åˆ°æœ‰æ•ˆï¼Œè¿‡äº†æ—¶é—´æ®µä¸ºå¤±è´¥**
>
> **3** **ï¼Œå‘˜å·¥ç­¾åˆ°å¿…é¡»è¦åœ¨å…¬å¸ä½ç½®** **100** **ç±³èŒƒå›´å†…ä¸ºæœ‰æ•ˆç­¾åˆ°ï¼Œå¯ä»¥å€Ÿç”¨ç™¾åº¦åœ°å›¾**
>
> **5** **ï¼Œè€ƒå‹¤è®°å½•åˆ†ä¸ºæ­£å¸¸ï¼Œæ—·å·¥ï¼Œæ—©é€€ï¼Œè¿Ÿåˆ°å››ç§æƒ…å†µ**
>
> **6** **ï¼Œé¢†å¯¼ç®¡ç†æƒé™æ›´é«˜ï¼Œå¯ä»¥æŸ¥çœ‹ï¼Œä¿®æ”¹è€ƒå‹¤è®°å½•ï¼ŒèŒå·¥æƒé™ä½Žï¼Œåªèƒ½æŸ¥çœ‹è€ƒå‹¤è®°å½•**
>
> **7** **ï¼Œé¢†å¯¼å¯ä»¥æ‰¹å‡å’Œä¸æ‰¹å‡ï¼ŒèŒå·¥å¯ä»¥è¯·å‡**
>
> **8** **ï¼Œå¤©æ°”é¢„æŠ¥åŠŸèƒ½é¢„æŠ¥ç¬¬äºŒå¤©å¤©æ°”**
>
> **9** **ï¼Œé£Žæ ¼å®šä¹‰ä¸ºæ·¡è“è‰²ï¼Œç™½è‰²ï¼Œç®€æ´**

#### äºŒã€è¿è¡ŒçŽ¯å¢ƒ

> 1ï¼šå®¢æˆ·ç«¯ä½¿ç”¨Android stuidoè¿›è¡Œå¼€å‘ï¼›  
>  2ï¼šæœåŠ¡ç«¯åŽå°ä½¿ç”¨Myeclipse2014è¿›è¡Œå¼€å‘ï¼›  
>  3ï¼šmysqlæ•°æ®åº“è¿›è¡Œæ•°æ®å­˜å‚¨ï¼›  
>  4ï¼šéœ€è¦jdk1.7ä»¥ä¸Š  
>  5ï¼šä½¿ç”¨é›·ç”µæ¨¡æ‹Ÿå™¨æˆ–è€…Androidstuioè‡ªå¸¦çš„æ¨¡æ‹Ÿå™¨è¿›è¡Œè¿è¡Œ

#### ä¸‰ã€ä½¿ç”¨æŠ€æœ¯

> **æ€»ä½“è®¾è®¡é€»è¾‘å’Œæ€è·¯ï¼š**  
>  1ï¼šå…ˆè®¾è®¡æ•°æ®åº“è¡¨æ–‡ä»¶  
>  2ï¼šå†™æœåŠ¡ç«¯jspé¡µé¢ä»¥åŠå†™apiæŽ¥å£ç»™å®¢æˆ·ç«¯æä¾›æ•°æ®  
>  3ï¼šå®ŒæˆåŽå°æœåŠ¡ç«¯çš„æ•°æ®äº¤äº’ï¼Œä¹Ÿå°±æ˜¯jspé¡µé¢æ•°æ®çš„å­˜å‚¨å’Œæ˜¾ç¤º  
>  4ï¼šè¿›è¡Œå®¢æˆ·ç«¯é¡µé¢çš„å¼€å‘ï¼›  
>  5ï¼šè¿›è¡Œå®¢æˆ·ç«¯å¯¹apiæŽ¥å£çš„è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯èŽ·å–æ•°æ®åº“çš„æ•°æ®ä»¥åŠåœ¨å®¢æˆ·ç«¯è¿›è¡Œæ˜¾ç¤º
>
> **ç§»åŠ¨ç«¯ï¼š**  
>  1ï¼šä½¿ç”¨androidåŽŸç”ŸæŽ§ä»¶ä»¥åŠxmlå¸ƒå±€æ–‡ä»¶æ¥å®Œæˆç•Œé¢çš„æ˜¾ç¤º  
>  2ï¼šä½¿ç”¨javaä»£ç å®ŒæˆåŠŸèƒ½çš„æ•°æ®å’Œé€»è¾‘äº¤äº’  
>  3ï¼šä½¿ç”¨httpç½‘ç»œè¯·æ±‚å®Œæˆæ•°æ®çš„è¯·æ±‚ï¼›  
>  **4ï¼šä½¿ç”¨jsonæ•°æ®è§£æžå®Œæˆå®¢æˆ·ç«¯æ•°æ®çš„å›žè°ƒå’Œæ˜¾ç¤º**
>
> **æœåŠ¡ç«¯åŽå°ï¼š**  
>  1ï¼šä½¿ç”¨mysqlå®Œæˆæ•°æ®çš„å­˜å‚¨  
>  2ï¼šä½¿ç”¨jdbcå®Œæˆæ•°æ®åº“å’Œä»£ç çš„é€»è¾‘äº¤äº’  
>  3ï¼šä½¿ç”¨jspå®Œæˆç½‘é¡µæ•°æ®çš„æ˜¾ç¤º  
>  4ï¼šä½¿ç”¨javaä»£ç å®ŒæˆapiæŽ¥å£çš„ç¼–å†™ä»¥åŠä»¥åŠæ•°æ®çš„å›žè°ƒ

#### å››ã€æ•°æ®åº“è®¾è®¡

> /*  
>  Navicat MySQL Data Transfer
>
> Source Server : mydb  
>  Source Server Version : 50528  
>  Source Host : localhost:3306  
>  Source Database : checkdb
>
> Target Server Type : MYSQL  
>  Target Server Version : 50528  
>  File Encoding : 65001
>
> Date: 2019-03-13 01:32:51  
>  */
>
> SET FOREIGN_KEY_CHECKS=0;
>
> \-- ----------------------------  
>  \-- Table structure for companysigntb  
>  \-- ----------------------------  
>  DROP TABLE IF EXISTS `companysigntb`;  
>  CREATE TABLE `companysigntb` (  
>  `companysignId` int(50) NOT NULL AUTO_INCREMENT,  
>  `companysignStartTime` varchar(255) DEFAULT NULL,  
>  `companysignCoordinate` varchar(255) DEFAULT NULL,  
>  `companysignState` varchar(255) DEFAULT NULL,  
>  PRIMARY KEY (`companysignId`)  
>  ) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8;
>
> \-- ----------------------------  
>  \-- Records of companysigntb  
>  \-- ----------------------------  
>  INSERT INTO `companysigntb` VALUES ('6', '2019-03-13 00:15:21',
> '108.948367,34.251385', 'ç­¾åˆ°');  
>  INSERT INTO `companysigntb` VALUES ('7', '2019-03-13 00:28:31',
> '108.948367,34.251385', 'ç­¾åˆ°');  
>  INSERT INTO `companysigntb` VALUES ('8', '2019-03-13 00:31:26',
> '108.948367,34.251385', 'ç­¾åˆ°');  
>  INSERT INTO `companysigntb` VALUES ('9', '2019-03-13 00:42:54',
> '108.948367,34.251385', 'ç­¾åˆ°');  
>  INSERT INTO `companysigntb` VALUES ('10', '2019-03-13 01:28:28',
> '108.948367,34.251385', 'ç­¾åˆ°');
>
> \-- ----------------------------  
>  \-- Table structure for companytb  
>  \-- ----------------------------  
>  DROP TABLE IF EXISTS `companytb`;  
>  CREATE TABLE `companytb` (  
>  `companyId` int(50) NOT NULL AUTO_INCREMENT,  
>  `companyName` varchar(255) DEFAULT NULL,  
>  `companyAddress` varchar(255) DEFAULT NULL,  
>  `companyCoordinate` varchar(255) DEFAULT NULL,  
>  `companyUserId` varchar(11) DEFAULT NULL,  
>  `companyUserName` varchar(255) DEFAULT NULL,  
>  `companyTime` varchar(100) DEFAULT NULL,  
>  PRIMARY KEY (`companyId`)  
>  ) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;
>
> \-- ----------------------------  
>  \-- Records of companytb  
>  \-- ----------------------------  
>  INSERT INTO `companytb` VALUES ('2', 'å¤šå¤šç§‘æŠ€', 'è¥¿å®‰å¸‚é›å¡”åŒº',
> '108.948367,34.251385', '108', 'tom', '2019-03-12 23:58');
>
> \-- ----------------------------  
>  \-- Table structure for leavetb  
>  \-- ----------------------------  
>  DROP TABLE IF EXISTS `leavetb`;  
>  CREATE TABLE `leavetb` (  
>  `leaveId` int(50) NOT NULL AUTO_INCREMENT,  
>  `leaveStartTime` varchar(100) DEFAULT NULL,  
>  `leaveEndTime` varchar(100) DEFAULT NULL,  
>  `leaveMessage` varchar(255) DEFAULT NULL,  
>  `leaveUserId` varchar(11) DEFAULT NULL,  
>  `leaveUserName` varchar(255) DEFAULT NULL,  
>  `leaveTime` varchar(100) DEFAULT NULL,  
>  `leaveState` varchar(255) DEFAULT NULL,  
>  PRIMARY KEY (`leaveId`)  
>  ) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;
>
> \-- ----------------------------  
>  \-- Records of leavetb  
>  \-- ----------------------------  
>  INSERT INTO `leavetb` VALUES ('1', '2019-03-12 23:01', '2019-03-14 23:01',
> 'æœ‰äº‹æƒ…éœ€è¦ç´§æ€¥å¤„ç†ï¼Œæœ›æ‰¹å‡†ï¼', '109', 'tom', '2019-03-12', '2');  
>  INSERT INTO `leavetb` VALUES ('2', '2019-04-12 22:25', '2019-05-12 23:25',
> 'æœ‰äº‹æƒ…éœ€è¦ç´§æ€¥å¤„ç†ï¼Œæœ›æ‰¹å‡†ï¼', '109', 'pony', '2019-03-12', '3');  
>  INSERT INTO `leavetb` VALUES ('3', '2019-03-13 01:28', '2019-03-15 01:28',
> 'æœ‰äº‹æƒ…éœ€è¦ç´§æ€¥å¤„ç†ï¼Œæœ›æ‰¹å‡†ï¼', '110', 'å°å¤šè¯»', '2019-03-13', '2');  
>  INSERT INTO `leavetb` VALUES ('4', '2019-03-15 01:28', '2019-04-13 01:28',
> 'æœ‰äº‹æƒ…éœ€è¦ç´§æ€¥å¤„ç†ï¼Œæœ›æ‰¹å‡†ï¼', '110', 'å°å¤šè¯»', '2019-03-13', '3');
>
> \-- ----------------------------  
>  \-- Table structure for signtb  
>  \-- ----------------------------  
>  DROP TABLE IF EXISTS `signtb`;  
>  CREATE TABLE `signtb` (  
>  `signId` int(50) NOT NULL AUTO_INCREMENT,  
>  `signUserId` varchar(11) DEFAULT NULL,  
>  `signUserName` varchar(255) DEFAULT NULL,  
>  `signTime` varchar(100) DEFAULT NULL,  
>  `signType` varchar(255) DEFAULT NULL,  
>  PRIMARY KEY (`signId`)  
>  ) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;
>
> \-- ----------------------------  
>  \-- Records of signtb  
>  \-- ----------------------------  
>  INSERT INTO `signtb` VALUES ('1', '109', 'pony', '2019-03-13', 'æ­£å¸¸');  
>  INSERT INTO `signtb` VALUES ('2', '110', 'å°å¤šè¯»', '2019-03-13', 'æ­£å¸¸');
>
> \-- ----------------------------  
>  \-- Table structure for user  
>  \-- ----------------------------  
>  DROP TABLE IF EXISTS `user`;  
>  CREATE TABLE `user` (  
>  `userId` int(255) NOT NULL AUTO_INCREMENT,  
>  `userName` varchar(200) CHARACTER SET utf8 NOT NULL,  
>  `userPhone` varchar(100) CHARACTER SET utf8 NOT NULL,  
>  `userPswd` varchar(200) CHARACTER SET utf8 NOT NULL,  
>  `userTime` varchar(300) CHARACTER SET utf8 NOT NULL,  
>  `userType` varchar(255) CHARACTER SET utf8 DEFAULT NULL,  
>  `companyCoordinate` varchar(255) CHARACTER SET utf8 DEFAULT NULL,  
>  PRIMARY KEY (`userId`)  
>  ) ENGINE=InnoDB AUTO_INCREMENT=112 DEFAULT CHARSET=latin1;
>
> \-- ----------------------------  
>  \-- Records of user  
>  \-- ----------------------------  
>  INSERT INTO `user` VALUES ('108', 'tom', '15249243002', '123456',
> '2019-03-12 16:38', 'é¢†å¯¼', '108.948367,34.251385');  
>  INSERT INTO `user` VALUES ('109', 'pony', '15249243001', '123456',
> '2019-03-12 16:39', 'å‘˜å·¥', null);  
>  INSERT INTO `user` VALUES ('110', 'å°å¤šè¯»', '15249243003', '123456',
> '2019-03-12 23:48', 'å‘˜å·¥', null);  
>  INSERT INTO `user` VALUES ('111', 'å°è‰¾', '15249243004', '123456',
> '2019-03-12 23:49', 'å‘˜å·¥', null);  
>

#### äº”ã€éƒ¨åˆ†ä»£ç 

##### 1ï¼šå‘˜å·¥ç­¾åˆ°

>  
>  public class SignMessageActivity extends BaseActivity implements
> AMapLocationListener, LocationSource, AMap.OnMarkerClickListener {  
>  SceneryModel sceneryModel;  
>  float distance;  
>  // title  
>  private TextView mTvTitle;  
>  // è¿”å›ž  
>  private ImageView mIvBack;  
>  private TextView mtvMessagetitle;  
>  private TextView mtvShopPriceTip;  
>  private Button mbtnPay;  
>  private TextView mIvStu;  
>  private AmapTTSController amapTTSController;  
>  private LocationSource.OnLocationChangedListener mListener;  
>  private AMapLocationClient mlocationClient;  
>  private AMapLocationClientOption mLocationOption;  
>  // å®šä½è¿”å›žçš„æ•°æ®ä¿¡æ¯  
>  private AMapLocation aMapLocationMessage;  
>  private AMap aMap;  
>  private MapView mapView;  
>  private MediaPlayer mediaPlayer;  
>  private SensorEventHelper mSensorHelper;
>
> private TextView mtvType;
>
> @Override  
>  protected void onCreate(Bundle savedInstanceState) {  
>  super.onCreate(savedInstanceState);  
>  setContentView(R.layout.activity_shop_message);  
>  mapView = (MapView) findViewById(R.id.mMapView);  
>  mapView.onCreate(savedInstanceState);// æ­¤æ–¹æ³•å¿…é¡»é‡å†™  
>  init();  
>  initWidget();  
>  initData();  
>  }
>
> /**  
>  * åˆå§‹åŒ–  
>  */  
>  private void init() {  
>  if (aMap == null) {  
>  aMap = mapView.getMap();
>
> setUpMap();  
>  }  
>  mSensorHelper = new SensorEventHelper(this);  
>  if (mSensorHelper != null) {  
>  mSensorHelper.registerSensorListener();  
>  }
>
> }
>
> @Override  
>  public void initWidget() {  
>  mtvType = (TextView) findViewById(R.id.mtvType);
>
> mtvShopPriceTip = (TextView) findViewById(R.id.mtvShopPriceTip);  
>  mIvStu = (TextView) findViewById(R.id.mIvStu);  
>  mbtnPay = (Button) findViewById(R.id.mbtnPay);  
>  mbtnPay.setOnClickListener(this);  
>  mtvMessagetitle = (TextView) findViewById(R.id.mtvMessagetitle);  
>  mIvBack = (ImageView) findViewById(R.id.mIvBack);  
>  mTvTitle = (TextView) findViewById(R.id.mTvTitle);  
>  mTvTitle.setText("å‘˜å·¥ç­¾åˆ°è¯¦æƒ…");  
>  mIvBack.setVisibility(View.VISIBLE);  
>  mIvBack.setOnClickListener(this);  
>  mIvStu.setVisibility(View.GONE);  
>  mIvStu.setOnClickListener(this);  
>  listAllUser(false);  
>  }
>
>  
>  private void listAllUser(boolean isShow) {  
>  AjaxParams params = new AjaxParams();  
>  params.put("action_flag", "listSignMessagePhone");  
>  httpPost(Consts.URL + Consts.APP.MessageAction, params,
> Consts.actionId.resultState, isShow, "æ­£åœ¨æ›´æ–°...");  
>  }
>
>  
>  private void addSign(boolean isShow) {  
>  SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd");// è®¾ç½®æ—¥æœŸæ ¼å¼  
>  AjaxParams params = new AjaxParams();  
>  params.put("action_flag", "addSign");  
>  params.put("signUserId", MemberUserUtils.getUid(this));  
>  params.put("signUserName", MemberUserUtils.getName(this));  
>  params.put("signTime", df.format(new Date()));  
>  params.put("signType", "æ­£å¸¸");  
>  httpPost(Consts.URL + Consts.APP.MessageAction, params,
> Consts.actionId.resultCode, isShow, "æ­£åœ¨æ›´æ–°...");  
>  }
>
> private List<SignCompanyModel> list_result = new
> ArrayList<SignCompanyModel>();  
>  @Override  
>  protected void callBackSuccess(ResponseEntry entry, int actionId) {  
>  super.callBackSuccess(entry, actionId);
>
> switch (actionId) {
>
> case Consts.actionId.resultState:
>
> if (null != entry.getData() && !TextUtils.isEmpty(entry.getData())) {  
>  String jsonMsg = entry.getData().substring(1, entry.getData().length() -
> 1);
>
> if (null != jsonMsg && !TextUtils.isEmpty(jsonMsg)) {  
>  list_result.clear();  
>  list_result = mGson.fromJson(entry.getData(), new
> TypeToken<List<SignCompanyModel>>() {  
>  }.getType());
>
> SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");// è®¾ç½®æ—¥æœŸæ ¼å¼  
>  SimpleDateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd
> HH:mm:ss");// 24å°æ—¶åˆ¶  
>  long timeChoice = 0;  
>  long nowChoice = 0;
>
> try {  
>  timeChoice =
> simpleDateFormat.parse(list_result.get(list_result.size()-1).getCompanysignStartTime()).getTime();  
>  nowChoice = simpleDateFormat.parse(df.format(new Date()) + "").getTime();
>
>  
>
> mtvType.setText("è·ç¦»"+list_result.get(list_result.size()-1).getCompanysignState()+"ç»“æŸè¿˜æœ‰");  
>  } catch (ParseException e) {  
>  // TODO Auto-generated catch block  
>  e.printStackTrace();  
>  }
>
>  
>  leftTime = 300-((nowChoice - timeChoice) / 1000);
>
> if(leftTime<300){  
>  handler.postDelayed(update_thread, 1000);  
>  }else{  
>  mtvType.setText("å·²ç»“æŸ");  
>  }
>
>  
>  } else {  
>  }  
>  }else{
>
> }  
>  break;  
>  case Consts.actionId.resultCode:  
>  CustomToast.showToast(this,entry.getRepMsg());  
>  break;  
>  }  
>  }
>
> /**  
>  * è®¾ç½®ä¸€äº›amapçš„å±žæ€§  
>  */  
>  private void setUpMap() {  
>  aMap.setLocationSource(this);// è®¾ç½®å®šä½ç›‘å¬  
>  aMap.getUiSettings().setMyLocationButtonEnabled(true);// è®¾ç½®é»˜è®¤å®šä½æŒ‰é’®æ˜¯å¦æ˜¾ç¤º  
>  aMap.setMyLocationEnabled(true);//
> è®¾ç½®ä¸ºtrueè¡¨ç¤ºæ˜¾ç¤ºå®šä½å±‚å¹¶å¯è§¦å‘å®šä½ï¼Œfalseè¡¨ç¤ºéšè—å®šä½å±‚å¹¶ä¸å¯è§¦å‘å®šä½ï¼Œé»˜è®¤æ˜¯false  
>  // è®¾ç½®å®šä½çš„ç±»åž‹ä¸ºå®šä½æ¨¡å¼ ï¼Œå¯ä»¥ç”±å®šä½ã€è·Ÿéšæˆ–åœ°å›¾æ ¹æ®é¢å‘æ–¹å‘æ—‹è½¬å‡ ç§  
>  aMap.setMyLocationType(AMap.LOCATION_TYPE_LOCATE);
>
> }
>
> @Override  
>  public void onClick(View v) {
>
> switch (v.getId()) {  
>  case R.id.mIvBack:  
>  SignMessageActivity.this.finish();  
>  break;
>
> case R.id.mbtnPay:
>
> if (distance> 100) {  
>  CustomToast.showToast(this, "ä½ ä¸åœ¨æ‰“å¡èŒƒå›´å†…ï¼");  
>  return;  
>  }
>
> addSign(true);  
>  break;  
>  }  
>  }  
>  long leftTime ;  
>  @SuppressLint("SetTextI18n")  
>  @Override  
>  public void initData() {
>
>  
>  }
>
> boolean addDataFlag = true;  
>  @Override  
>  public void onLocationChanged(AMapLocation amapLocation) {  
>  if (amapLocation != null) {  
>  if (amapLocation.getErrorCode() == 0) {  
>  // å®šä½æˆåŠŸå›žè°ƒä¿¡æ¯ï¼Œè®¾ç½®ç›¸å…³æ¶ˆæ¯  
>  amapLocation.getLocationType();// èŽ·å–å½“å‰å®šä½ç»“æžœæ¥æºï¼Œå¦‚ç½‘ç»œå®šä½ç»“æžœï¼Œè¯¦è§å®šä½ç±»åž‹è¡¨  
>  amapLocation.getLatitude();// èŽ·å–çº¬åº¦  
>  amapLocation.getLongitude();// èŽ·å–ç»åº¦  
>  amapLocation.getAccuracy();// èŽ·å–ç²¾åº¦ä¿¡æ¯
>
>  
>  if(list_result.size()>0){  
>  String coordinate
> =list_result.get(list_result.size()-1).getCompanysignCoordinate();  
>  LatLng my = new LatLng( amapLocation.getLatitude(),
> amapLocation.getLongitude());  
>  LatLng end = new LatLng(Double.valueOf(coordinate.split(",")[1]),
> Double.valueOf(coordinate.split(",")[0]));  
>  distance = AMapUtils.calculateLineDistance(my, end);  
>  // mtvShopPriceTip.setText("è·ç¦»å…¬å¸ï¼š" + formatDouble5(distance * 0.001) +
> "km");
>
> mtvShopPriceTip.setText("è·ç¦»å…¬å¸ï¼š" + formatDouble5(distance ) + "m");
>
>  
>  }
>
>  
>  Log.i("pony_log", "è·ç¦»å’Œä½ç½®ï¼š" + amapLocation.getAddress() + ",distance:" +
> distance);  
>  // Log.i("pony_log", "èŽ·å–å®šä½æ•°æ®ï¼š" + amapLocation.getLatitude() + "," +
> amapLocation.getLongitude());  
>  } else {  
>  // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ErrCodeæ˜¯é”™è¯¯ç ï¼ŒerrInfoæ˜¯é”™è¯¯ä¿¡æ¯ï¼Œè¯¦è§é”™è¯¯ç è¡¨ã€‚  
>  Log.e("AmapError", "location Error, ErrCode:" + amapLocation.getErrorCode()
> + ", errInfo:" + amapLocation.getErrorInfo());  
>  }  
>  }  
>  }
>
> public static String formatDouble5(double d) {  
>  return String.format("%.2f", d);  
>  }
>
>  
>  /**  
>  * æ–¹æ³•å¿…é¡»é‡å†™  
>  */  
>  @Override  
>  public void onResume() {  
>  super.onResume();
>
> mapView.onResume();  
>  initWidget();  
>  initData();  
>  if (mSensorHelper != null) {  
>  mSensorHelper.registerSensorListener();  
>  } else {  
>  mSensorHelper = new SensorEventHelper(this);  
>  if (mSensorHelper != null) {  
>  mSensorHelper.registerSensorListener();
>
>  
>  }  
>  }  
>  }
>
> /**  
>  * æ–¹æ³•å¿…é¡»é‡å†™  
>  */  
>  @Override  
>  public void onPause() {  
>  super.onPause();  
>  if (mSensorHelper != null) {  
>  mSensorHelper.unRegisterSensorListener();  
>  mSensorHelper.setCurrentMarker(null);  
>  mSensorHelper = null;  
>  }  
>  mapView.onPause();  
>  deactivate();
>
> }
>
> /**  
>  * æ–¹æ³•å¿…é¡»é‡å†™  
>  */  
>  @Override  
>  public void onSaveInstanceState(Bundle outState) {  
>  super.onSaveInstanceState(outState);  
>  mapView.onSaveInstanceState(outState);  
>  }
>
> /**  
>  * æ–¹æ³•å¿…é¡»é‡å†™  
>  */  
>  @Override  
>  public void onDestroy() {  
>  super.onDestroy();  
>  mapView.onDestroy();  
>  if (null != mlocationClient) {  
>  mlocationClient.onDestroy();  
>  }
>
> }
>
> /**  
>  * åœæ­¢å®šä½  
>  */  
>  @Override  
>  public void deactivate() {  
>  mListener = null;  
>  if (mlocationClient != null) {  
>  mlocationClient.stopLocation();  
>  mlocationClient.onDestroy();  
>  }  
>  mlocationClient = null;  
>  }
>
>  
>  /**  
>  * æ¿€æ´»å®šä½  
>  */  
>  @Override  
>  public void activate(OnLocationChangedListener listener) {  
>  mListener = listener;  
>  if (mlocationClient == null) {  
>  mlocationClient = new AMapLocationClient(this);  
>  mLocationOption = new AMapLocationClientOption();  
>  // // è®¾ç½®å®šä½ç›‘å¬  
>  mlocationClient.setLocationListener(this);  
>  // // è®¾ç½®ä¸ºé«˜ç²¾åº¦å®šä½æ¨¡å¼  
>
> mLocationOption.setLocationMode(AMapLocationClientOption.AMapLocationMode.Hight_Accuracy);  
>  // è®¾ç½®å®šä½å‚æ•°  
>  // mlocationClient.setLocationOption(mLocationOption);  
>  // æ­¤æ–¹æ³•ä¸ºæ¯éš”å›ºå®šæ—¶é—´ä¼šå‘èµ·ä¸€æ¬¡å®šä½è¯·æ±‚ï¼Œä¸ºäº†å‡å°‘ç”µé‡æ¶ˆè€—æˆ–ç½‘ç»œæµé‡æ¶ˆè€—ï¼Œ  
>  // æ³¨æ„è®¾ç½®åˆé€‚çš„å®šä½æ—¶é—´çš„é—´éš”ï¼ˆæœ€å°é—´éš”æ”¯æŒä¸º2000msï¼‰ï¼Œå¹¶ä¸”åœ¨åˆé€‚æ—¶é—´è°ƒç”¨stopLocation()æ–¹æ³•æ¥å–æ¶ˆå®šä½è¯·æ±‚  
>  // åœ¨å®šä½ç»“æŸåŽï¼Œåœ¨åˆé€‚çš„ç”Ÿå‘½å‘¨æœŸè°ƒç”¨onDestroy()æ–¹æ³•  
>  // åœ¨å•æ¬¡å®šä½æƒ…å†µä¸‹ï¼Œå®šä½æ— è®ºæˆåŠŸä¸Žå¦ï¼Œéƒ½æ— éœ€è°ƒç”¨stopLocation()æ–¹æ³•ç§»é™¤è¯·æ±‚ï¼Œå®šä½sdkå†…éƒ¨ä¼šç§»é™¤
>
> //èŽ·å–ä¸€æ¬¡å®šä½ç»“æžœï¼š  
>  //è¯¥æ–¹æ³•é»˜è®¤ä¸ºfalseã€‚  
>  mLocationOption.setOnceLocation(true);  
>  //èŽ·å–æœ€è¿‘3så†…ç²¾åº¦æœ€é«˜çš„ä¸€æ¬¡å®šä½ç»“æžœï¼š  
>  //è®¾ç½®setOnceLocationLatest(boolean
> b)æŽ¥å£ä¸ºtrueï¼Œå¯åŠ¨å®šä½æ—¶SDKä¼šè¿”å›žæœ€è¿‘3så†…ç²¾åº¦æœ€é«˜çš„ä¸€æ¬¡å®šä½ç»“æžœã€‚å¦‚æžœè®¾ç½®å…¶ä¸ºtrueï¼ŒsetOnceLocation(boolean
> b)æŽ¥å£ä¹Ÿä¼šè¢«è®¾ç½®ä¸ºtrueï¼Œåä¹‹ä¸ä¼šï¼Œé»˜è®¤ä¸ºfalseã€‚  
>  mLocationOption.setOnceLocationLatest(true);  
>  mlocationClient.startLocation();  
>  }  
>  }
>
> private void openAssetMusics() {
>
> try {  
>  // æ’­æ”¾ assets/a2.mp3 éŸ³ä¹æ–‡ä»¶  
>  AssetFileDescriptor fd = this.getAssets().openFd("tipmusic.mp3");  
>  mediaPlayer = new MediaPlayer();  
>  mediaPlayer.setDataSource(fd.getFileDescriptor(), fd.getStartOffset(),
> fd.getLength());  
>  mediaPlayer.prepare();  
>  mediaPlayer.start();  
>  } catch (IOException e) {  
>  e.printStackTrace();  
>  }  
>  }
>
> Handler handler = new Handler();  
>  Runnable update_thread = new Runnable() {  
>  @Override  
>  public void run() {  
>  leftTime--;  
>  if (leftTime > 0) {  
>  //å€’è®¡æ—¶æ•ˆæžœå±•ç¤º  
>  String formatLongToTimeStr = formatLongToTimeStr(leftTime);  
>  mtvMessagetitle.setText(formatLongToTimeStr);  
>  //æ¯ä¸€ç§’æ‰§è¡Œä¸€æ¬¡  
>  handler.postDelayed(this, 1000);  
>  } else {//å€’è®¡æ—¶ç»“æŸ  
>  //å¤„ç†ä¸šåŠ¡æµç¨‹
>
> //å‘é€æ¶ˆæ¯ï¼Œç»“æŸå€’è®¡æ—¶  
>  Message message = new Message();  
>  message.what = 1;  
>  handlerStop.sendMessage(message);  
>  }  
>  }  
>  };
>
> @SuppressLint("HandlerLeak")  
>  final Handler handlerStop = new Handler() {  
>  public void handleMessage(Message msg) {  
>  switch (msg.what) {  
>  case 1:  
>  leftTime = 0;  
>  handler.removeCallbacks(update_thread);  
>  break;  
>  }  
>  super.handleMessage(msg);  
>  }
>
> };
>
>  
>  public String formatLongToTimeStr(Long l) {  
>  int hour = 0;  
>  int minute = 0;  
>  int second = 0;  
>  second = l.intValue() ;  
>  if (second > 60) {  
>  minute = second / 60; //å–æ•´  
>  second = second % 60; //å–ä½™  
>  }  
>  if (minute > 60) {  
>  hour = minute / 60;  
>  minute = minute % 60;  
>  }
>
> String minutemsg ="";  
>  String secondmsg ="";  
>  if(minute<10){  
>  minutemsg="0"+minute;  
>  }else{  
>  minutemsg=minute+"";  
>  }
>
> if(second<10){  
>  secondmsg="0"+second;  
>  }else{  
>  secondmsg=""+second;  
>  }
>
> String strtime = minutemsg+"ï¼š"+secondmsg;  
>  return strtime;  
>  }
>
> @Override  
>  public boolean onMarkerClick(Marker marker) {  
>  return false;  
>  }  
>  }  
>

##### 2ï¼šç”¨æˆ·ç™»å½•

>  
>  public class LoginActivity extends BaseActivity {  
>  // title  
>  private TextView mTvTitle;  
>  // ç™»å½•ç”¨æˆ·åç§°  
>  private EditText mLoginNumber;  
>  // ç™»å½•å¯†ç   
>  private EditText mLoginPswd;  
>  // ç™»å½•æŒ‰é’®  
>  private Button mLogin;  
>  private Button mEnterpriseQuery;  
>  private LinearLayout mllTop;  
>  private UserModel userModel;
>
>  
>  @Override  
>  protected void onCreate(Bundle savedInstanceState) {  
>  super.onCreate(savedInstanceState);  
>  setContentView(R.layout.activity_login);  
>  initWidget();  
>  }
>
> /**  
>  * æŽ§ä»¶åˆå§‹åŒ–  
>  */  
>  @Override  
>  public void initWidget() {
>
> mdialog = new LoadingDialog(this, "æ­£åœ¨ç™»å½•");  
>  mTvTitle = (TextView) findViewById(R.id.mTvTitle);  
>  mTvTitle.setText("ç™»å½•");  
>  mLoginNumber = (EditText) findViewById(R.id.mLoginNumber);  
>  mLoginPswd = (EditText) findViewById(R.id.mLoginPswd);  
>  mLogin = (Button) findViewById(R.id.mLogin);  
>  mEnterpriseQuery = (Button) findViewById(R.id.mEnterpriseQuery);  
>  // mLoginNumber.setInputType(EditorInfo.TYPE_CLASS_PHONE);  
>  // äº‹ä»¶çš„ç›‘å¬  
>  mLogin.setOnClickListener(this);  
>  mEnterpriseQuery.setOnClickListener(this);  
>  // ç»™è¾“å…¥æ¡†è®¾ç½®é»˜è®¤çš„æµ‹è¯•æ•°æ®  
>  mLoginNumber.setSelection(mLoginNumber.getText().length());
>
> mLoginNumber.setText("15249243001");  
>  mLoginPswd.setText("123456");
>
> }
>
> @Override  
>  public void onClick(View v) {
>
> switch (v.getId()) {  
>  case R.id.mLogin:  
>  if (TextUtils.isEmpty(mLoginNumber.getText().toString())) {  
>  ToastUtil.ShowCentre(LoginActivity.this, "è¯·è¾“å…¥ç™»é™†è´¦å·");  
>  return;  
>  }  
>  if (TextUtils.isEmpty(mLoginPswd.getText().toString())) {  
>  ToastUtil.ShowCentre(LoginActivity.this, "è¯·è¾“å…¥ç™»å½•å¯†ç ");  
>  return;  
>  }  
>  LoginUserPost(true);  
>  break;
>
> case R.id.mEnterpriseQuery:  
>  Intent mEnterpriseQuery = new Intent(LoginActivity.this,
> RegisterActivity.class);  
>  startActivity(mEnterpriseQuery);  
>  default:  
>  break;  
>  }  
>  }
>
> @Override  
>  public void initData() {  
>  }
>
> /**  
>  * ç”¨æˆ·çš„ç™»å½•  
>  *  
>  * @param isShow  
>  */  
>  private void LoginUserPost(boolean isShow) {  
>  AjaxParams params = new AjaxParams();  
>  params.put("action_flag", "login");  
>  params.put("userPhone", mLoginNumber.getText().toString());  
>  params.put("userPswd", mLoginPswd.getText().toString());  
>  httpPost(Consts.URL + Consts.APP.RegisterAction, params,
> Consts.actionId.resultFlag, isShow, "æ­£åœ¨ç™»å½•...");  
>  }
>
> @Override  
>  protected void callBackSuccess(ResponseEntry entry, int actionId) {  
>  super.callBackSuccess(entry, actionId);
>
> switch (actionId) {  
>  case Consts.actionId.resultFlag:
>
> if (null != entry.getData() && !TextUtils.isEmpty(entry.getData())) {  
>  userModel = mGson.fromJson(entry.getData(), UserModel.class);  
>  MemberUserUtils.setUid(LoginActivity.this, userModel.getUserId());  
>  MemberUserUtils.setName(LoginActivity.this, userModel.getUserName());  
>  MemberUserUtils.setLoginFlag(LoginActivity.this, "food");  
>  MemberUserUtils.putBean(LoginActivity.this, "user_messgae", userModel);
>
> if(userModel.getUserType().equals("é¢†å¯¼")){  
>  Intent intent = new Intent(LoginActivity.this, FrameworkActivity.class);  
>  startActivity(intent);  
>  finish();  
>  }else{  
>  Intent intent = new Intent(LoginActivity.this,
> FrameworUserkActivity.class);  
>  startActivity(intent);  
>  finish();  
>  }
>
> }  
>  break;  
>  }
>
> }
>
> @Override  
>  protected void callBackAllFailure(String strMsg, int actionId) {  
>  super.callBackAllFailure(strMsg, actionId);  
>  ToastUtil.show(LoginActivity.this, strMsg);
>
> }
>
> }

#### å…­ã€æµè§ˆæ›´å¤šAndroidæ¯•ä¸šè®¾è®¡

[æ¯•ä¸šè®¾è®¡-åŸºäºŽandroidçš„ç§Ÿæˆ¿ä¿¡æ¯å‘å¸ƒå¹³å°çš„APP_ä¿¡æ¯å‘å¸ƒappæºç _Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-
CSDNåšå®¢](https://blog.csdn.net/u014388322/article/details/100656450?spm=1001.2014.3001.5502
"æ¯•ä¸šè®¾è®¡-åŸºäºŽandroidçš„ç§Ÿæˆ¿ä¿¡æ¯å‘å¸ƒå¹³å°çš„APP_ä¿¡æ¯å‘å¸ƒappæºç _Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-CSDNåšå®¢")

[æ¯•ä¸šè®¾è®¡-åŸºäºŽandroidé€‰è¯¾ç³»ç»Ÿçš„è®¾è®¡ä¸Žå®žçŽ°_androidå­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿ_Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-
CSDNåšå®¢](https://blog.csdn.net/u014388322/article/details/100656536?spm=1001.2014.3001.5502
"æ¯•ä¸šè®¾è®¡-åŸºäºŽandroidé€‰è¯¾ç³»ç»Ÿçš„è®¾è®¡ä¸Žå®žçŽ°_androidå­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿ_Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-CSDNåšå®¢")

[æ¯•ä¸šè®¾è®¡ä¹‹æ ¡å›­ä¸€å¡é€šç®¡ç†ç³»ç»Ÿçš„è®¾è®¡ä¸Žå®žçŽ°_ä¸€å¡é€šç®¡ç†ç³»ç»Ÿå®žçŽ°_Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-
CSDNåšå®¢](https://blog.csdn.net/u014388322/article/details/126048550?spm=1001.2014.3001.5502
"æ¯•ä¸šè®¾è®¡ä¹‹æ ¡å›­ä¸€å¡é€šç®¡ç†ç³»ç»Ÿçš„è®¾è®¡ä¸Žå®žçŽ°_ä¸€å¡é€šç®¡ç†ç³»ç»Ÿå®žçŽ°_Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-CSDNåšå®¢")

[åŸºäºŽAndroidçš„æ ¡å›­äºŒæ‰‹é—²ç½®ç‰©å“äº¤æ˜“ç³»ç»Ÿè®¾è®¡ä¸Žå®žçŽ°_åŸºäºŽandroidçš„äºŒæ‰‹äº¤æ˜“å¹³å°_Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-
CSDNåšå®¢](https://blog.csdn.net/u014388322/article/details/128232475?spm=1001.2014.3001.5502
"åŸºäºŽAndroidçš„æ ¡å›­äºŒæ‰‹é—²ç½®ç‰©å“äº¤æ˜“ç³»ç»Ÿè®¾è®¡ä¸Žå®žçŽ°_åŸºäºŽandroidçš„äºŒæ‰‹äº¤æ˜“å¹³å°_Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-CSDNåšå®¢")

[åŸºäºŽandroidstudioæ ¡å›­å¿«é€’APPç³»ç»Ÿçš„è®¾è®¡ä¸Žå®žçŽ°_android studioè®ºæ–‡_Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-
CSDNåšå®¢](https://blog.csdn.net/u014388322/article/details/128545390?spm=1001.2014.3001.5502
"åŸºäºŽandroidstudioæ ¡å›­å¿«é€’APPç³»ç»Ÿçš„è®¾è®¡ä¸Žå®žçŽ°_android studioè®ºæ–‡_Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-CSDNåšå®¢")

[åŸºäºŽandroidçš„å•†åŸŽè´­ç‰©å®šåˆ¶APP_å®‰å“å¼€å‘è´­ç‰©app_Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-
CSDNåšå®¢](https://blog.csdn.net/u014388322/article/details/128746697?spm=1001.2014.3001.5502
"åŸºäºŽandroidçš„å•†åŸŽè´­ç‰©å®šåˆ¶APP_å®‰å“å¼€å‘è´­ç‰©app_Androidæ¯•ä¸šè®¾è®¡æºç çš„åšå®¢-CSDNåšå®¢")

> æ›´å¤šæ¯•ä¸šè®¾è®¡å¯ä»¥æµè§ˆæˆ‘çš„ä¸ªäººä¸»é¡µå“¦ï¼

#### ä¸ƒã€æºç ä¸‹è½½

> â€‹<https://download.csdn.net/download/u014388322/88179100>

